# ❓ Часто задаваемые вопросы (FAQ)

## Установка и настройка

### Q: Где получить Telegram Bot Token?

**A:** 
1. Откройте Telegram и найдите бота [@BotFather](https://t.me/BotFather)
2. Отправьте команду `/newbot`
3. Введите имя для вашего бота (например: "Document Generator")
4. Введите username для бота (должен заканчиваться на 'bot', например: "my_doc_generator_bot")
5. BotFather выдаст вам токен вида: `1234567890:ABCdefGHIjklMNOpqrsTUVwxyz`
6. Скопируйте этот токен в файл `.env`

### Q: Где получить Google Gemini API Key?

**A:**
1. Перейдите на сайт [Google AI Studio](https://makersuite.google.com/app/apikey)
2. Войдите с помощью Google аккаунта
3. Нажмите "Create API Key" или "Get API Key"
4. Скопируйте сгенерированный ключ
5. Вставьте его в файл `.env` в переменную `GEMINI_API_KEY`

### Q: Какая версия Python требуется?

**A:** Python 3.8 или выше. Рекомендуется Python 3.10 или 3.11.

Проверить версию:
```bash
python3 --version
```

### Q: Как проверить, что все зависимости установлены?

**A:**
```bash
pip list
```

Убедитесь, что установлены: aiogram, google-generativeai, python-docx, reportlab

## Использование

### Q: Сколько времени занимает генерация документа?

**A:** Обычно 10-30 секунд в зависимости от:
- Сложности запроса
- Загруженности Gemini API
- Типа документа (Word генерируется быстрее, чем PDF)

### Q: Есть ли ограничения на количество запросов?

**A:** Да, Google Gemini API имеет rate limits:
- Бесплатный tier: 60 запросов в минуту
- При превышении лимита будет ошибка

### Q: Можно ли сохранить историю созданных документов?

**A:** В текущей версии документы отправляются пользователю и удаляются с сервера. Для сохранения истории можно:
1. Отключить автоматическое удаление в `document_service.py`
2. Реализовать базу данных для хранения метаданных

### Q: Какого размера могут быть сгенерированные документы?

**A:** 
- Ограничение на ввод: 1000 символов (настраивается в `config.py`)
- Выходной документ может содержать 1000-5000 слов
- Размер файла: обычно 20-500 KB

## Проблемы и решения

### Q: Бот не отвечает на команды

**A:** Проверьте:
1. Правильность токена в `.env`
2. Запущен ли бот (`python -m telegram_doc_bot.bot`)
3. Нет ли ошибок в консоли/логах
4. Интернет-соединение

### Q: Ошибка "TELEGRAM_BOT_TOKEN не установлен"

**A:** 
1. Проверьте наличие файла `.env` в корне проекта
2. Убедитесь, что переменная называется точно `TELEGRAM_BOT_TOKEN`
3. Проверьте, что нет лишних пробелов: `TELEGRAM_BOT_TOKEN=ваш_токен`

### Q: Ошибка "Failed to generate content" или пустой ответ от Gemini

**A:** Возможные причины:
1. Неверный API ключ Gemini - проверьте в `.env`
2. Исчерпан лимит запросов - подождите минуту
3. Проблемы с интернетом
4. Запрос содержит недопустимый контент

Решение:
- Проверьте API ключ
- Попробуйте более простой запрос
- Проверьте логи: `tail -f bot.log`

### Q: PDF документ не создаётся / ошибка с шрифтами

**A:** ReportLab использует стандартные шрифты. Если нужны кириллические символы:
1. Проверьте версию reportlab: `pip show reportlab`
2. Переустановите: `pip install --upgrade reportlab`

### Q: Бот падает с ошибкой памяти

**A:** 
1. Проверьте доступную память: `free -h`
2. Увеличьте swap (для Linux)
3. Ограничьте размер генерируемого контента в `config.py`

### Q: Как посмотреть логи бота?

**A:**
```bash
# Последние записи
tail -n 50 bot.log

# Следить за логами в реальном времени
tail -f bot.log

# Поиск ошибок
grep ERROR bot.log
```

## Настройка и кастомизация

### Q: Как изменить максимальную длину запроса?

**A:** В файле `telegram_doc_bot/config.py`:
```python
MAX_REQUEST_LENGTH = 2000  # Измените значение
```

### Q: Как добавить новый тип шаблона?

**A:**
1. Добавьте шаблон в `config.py`:
```python
DOCUMENT_TEMPLATES = {
    'invoice': 'Счёт на оплату',  # новый шаблон
    # ... остальные
}
```

2. Добавьте промпт в `services/gemini_service.py` в метод `_create_prompt`:
```python
'invoice': """
Создай счёт на оплату на основе запроса:
{request}
...
"""
```

### Q: Как изменить стиль форматирования документов?

**A:** Отредактируйте `services/document_service.py`:
- Для Word: измените шрифты, размеры, отступы в методе `create_word_document`
- Для PDF: измените стили в методе `create_pdf_document`

### Q: Можно ли запустить несколько ботов одновременно?

**A:** Да, но нужны разные токены для каждого бота. Создайте несколько ботов через @BotFather.

## Развёртывание

### Q: Как запустить бота на сервере?

**A:** 
**Вариант 1: Screen/Tmux**
```bash
screen -S telegram_bot
./start.sh
# Нажмите Ctrl+A, затем D для отсоединения
```

**Вариант 2: Systemd**
```bash
sudo cp telegram-bot.service /etc/systemd/system/
# Отредактируйте пути в файле
sudo systemctl enable telegram-bot
sudo systemctl start telegram-bot
```

**Вариант 3: Docker**
```bash
docker-compose up -d
```

### Q: Как обновить бота до новой версии?

**A:**
```bash
git pull
source venv/bin/activate
pip install -r requirements.txt --upgrade
# Перезапустите бота
```

### Q: Как сделать бота доступным 24/7?

**A:** 
1. Используйте VPS (DigitalOcean, Hetzner, AWS)
2. Настройте автозапуск через systemd или supervisor
3. Или используйте Docker с restart: always

### Q: Какие ресурсы нужны для сервера?

**A:** Минимальные требования:
- CPU: 1 ядро
- RAM: 512 MB (рекомендуется 1 GB)
- Диск: 2 GB
- ОС: Ubuntu 20.04/22.04 или Debian

## Безопасность

### Q: Безопасно ли использовать бота?

**A:** Бот безопасен при соблюдении правил:
1. Не храните `.env` в публичных репозиториях
2. Не делитесь API ключами
3. Регулярно обновляйте зависимости
4. Используйте HTTPS для сервера (если разворачиваете webhook)

### Q: Хранятся ли данные пользователей?

**A:** В текущей версии:
- Не сохраняются личные данные
- Запросы не логируются полностью (только первые 50 символов)
- Документы удаляются после отправки
- Для соответствия GDPR - готово к использованию

### Q: Может ли бот работать с конфиденциальными документами?

**A:** **Осторожно!**
- Данные отправляются в Google Gemini API
- Не используйте для строго конфиденциальной информации
- Для конфиденциальных документов используйте локальные LLM (Llama, Mistral)

## Производительность

### Q: Сколько пользователей может обслуживать бот?

**A:** 
- До 100 активных пользователей: без проблем
- 100-1000: нужна оптимизация и rate limiting
- 1000+: требуется масштабирование (несколько инстансов, очереди)

### Q: Как ускорить генерацию документов?

**A:**
1. Используйте более быстрый сервер
2. Кешируйте часто используемые шаблоны
3. Оптимизируйте промпты
4. Используйте async/await правильно

## Разработка

### Q: Как добавить поддержку других форматов (Excel, HTML)?

**A:** 
1. Установите библиотеку (openpyxl для Excel)
2. Добавьте метод в `DocumentService`
3. Добавьте тип в `DOCUMENT_TYPES` в config.py
4. Обновите обработчик

### Q: Можно ли использовать другую LLM вместо Gemini?

**A:** Да! Замените `GeminiService`:
- OpenAI GPT: используйте библиотеку `openai`
- Anthropic Claude: используйте библиотеку `anthropic`
- Локальные модели: используйте `llama-cpp-python` или `transformers`

### Q: Как добавить базу данных?

**A:** Рекомендации:
1. SQLite для простых случаев: `aiosqlite`
2. PostgreSQL для production: `asyncpg` + `sqlalchemy`
3. MongoDB для документов: `motor`

Пример интеграции в `bot.py` через middleware.

## Лицензирование и использование

### Q: Можно ли использовать коммерчески?

**A:** Да, но учитывайте:
- Gemini API может потребовать платный план
- Соблюдайте условия использования Google AI
- Добавьте собственную лицензию в проект

### Q: Нужно ли указывать авторство?

**A:** Для данного открытого кода - желательно, но не обязательно.

---

**Не нашли ответ на вопрос?** Создайте Issue в репозитории или свяжитесь с поддержкой.
